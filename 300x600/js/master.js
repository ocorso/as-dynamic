/**
 * Dynamic Content Enable code for Profile: 1085016
 *
 * The following code initializes the following dynamic variables for
 * development testing and live serving of Fields associated to the above profile
 *   DynamicContent Start: HTML5 invocation code.
*/

// Dynamic Content variables and sample values

Enabler.setProfileId(1085016);
var devDynamicContent = {};

devDynamicContent.aslocalfeed_Allstate_Local_Feed = [{}];
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0]._id = 0;

devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation = "CSGN"; //oc: hardcode to variation for dev
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Is_Default = true;
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Exit_URL = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Exit_URL.Url = "https://www.onallstate.com/LP/2016/brand-campaign/localagents/";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].elemType = "LI ID";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Savings_Percentage = "33%";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Market_Name = "Massachusetts Area";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Legal_Copy = "Savings &amp; coverage subject to terms, conditions and availability. Savings Vary. Allstate Indemnity Co. &amp; Allstate Fire and Casualty Insurance Co. &amp; their Affiliates: Northbrook, IL. &copy;2015 Allstate Insurance Co.";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Background_Color = "#FF9E16";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_160x600 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_160x600.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_160x600.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_160x600 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_160x600.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_160x600.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_160x600 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_160x600.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_160x600.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_300x250 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_300x250.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_300x250.Url = "https://s0.2mdn.net/ads/richmedia/studio/44339383/TA_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_300x250 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_300x250.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_300x250.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_300x250 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_300x250.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_300x250.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_728x90 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_728x90.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_728x90.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_728x90 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_728x90.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_728x90.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_728x90 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_728x90.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_728x90.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_300x600 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_300x600.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_300x600.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_300x600 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_300x600.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_300x600.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_300x600 = {};
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_300x600.Type = "file";
devDynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_300x600.Url = "https://s0.2mdn.net/ads/richmedia/studio/44448670/37231879_20160721142255788_DF_image1_300x250.jpg";
Enabler.setDevDynamicContent(devDynamicContent);


/**
 * You may access the variables in the following manner
 * AFTER the Studio Enabler is initialized.
 * var Is_Default = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Is_Default;
 * Note: be sure to use "dynamicContent", not "devDynamicContent"
 * Note: be sure to use ExitOverride to create your exit URL dynamically; follow the instructions on our Help center: https://support.google.com/richmedia/answer/2664807
 */

var asApp = {};
asApp.type = {};
asApp.type.AF = 'AF'; //Accident Forgiveness
asApp.type.BSAHLP = 'BSAHLP'; //Bundle and Save Auto, Home, Life with Percentages
asApp.type.BSAH = 'BSAH'; //oc: Bundle and Save Auto, Home, NO Percentages
asApp.type.BSAHP = 'BSAHP'; //oc: Bundle and Save Auto, Home, WITH Percentages
asApp.type.BSAHL = 'BSAHL';
asApp.type.BSHLI = 'BSHLI';
asApp.type.BSALP = 'BSALP';
asApp.type.BSAL = 'BSAL';
asApp.type.BSAHMP = 'BSAHMP';
asApp.type.BSAHM = 'BSAHM';
asApp.type.BSACP = 'BSACP';
asApp.type.BSAC = 'BSAC';
asApp.type.CFD = 'CFD';
asApp.type.CFDM = 'CFDM';
asApp.type.CFR = 'CFR';
asApp.type.CRG = 'CRG';
asApp.type.CRGM = 'CRGM';
asApp.type.CSG = 'CSG';
asApp.type.CSGN = 'CSGN';
asApp.type.CSGM = 'CSGM';
asApp.type.DW = 'DW1';
asApp.type.DW2P = 'DW2P';
asApp.type.NR = 'NR';
asApp.type.TA1 = 'TA1';
asApp.type.TAM1 = 'TAM1';
asApp.type.TAM2 = 'TAM2';
asApp.type.WD = 'WD';
asApp.type.DF = 'DF';


if (!Enabler.isInitialized()) {
  Enabler.addEventListener(
    studio.events.StudioEvent.INIT,
    enablerInitialized);
} else {
  enablerInitialized();
}

function enablerInitialized() {
  // Enabler initialized.
  // In App ads are rendered offscreen so animation should wait for
  // the visible event. These are simulated with delays in the local
  // environment.
  if (!Enabler.isVisible()) {
    Enabler.addEventListener(
      studio.events.StudioEvent.VISIBLE,
      asApp.init);
  } else {
    asApp.init();
  }

  /*******************************************************************************
       Start of Adometry Tag for DoubleClick Dynamic Creatives: DO NOT REMOVE.
       Append this entire block to enablerInitHandler(), ONLY AFTER executing
       Enabler.setDevDynamicContent(devDynamicContent).  Be sure to set 'nid'
       below according to your Adometry account ID.
       nid = Adometry account id, pid = DCM placement id, cid = dynamic element ID
  ********************************************************************************/

  var nid = 3700;
  var pid = (function() {
    p = Enabler.getDartPageId();
    if (!isNaN(p)) return p;
    else return 0
  })();
  var cid = (function() {
    s = '';
    d = dynamicContent;
    for (x in d) {
      if (x != '_profileid')
        s += (d[x][0].elemType + d[x][0].ID);
    }
    for (var h = 0, i = 0; i < s.length; i++) h = h * 31 + s.charCodeAt(i);
    return h & 0x7FFFFFFF
  })();
  var str = 'https://js.dmtry.com/antenna2.js?0_' + nid + '_' + pid + '_' + cid;
  console.log(str);
  var script = document.createElement('script');
  script.src = str;
  document.body.appendChild(script);

/*******************************************************************************
      End Adometry Tag for DoubleClick Dynamic Creatives: DO NOT REMOVE.
********************************************************************************/
} //end function enabler init();

/**
 * This function is called when the Enabler is initialized.
 * Uses dynamic content to determine which variation to display
 *
 */
asApp.init = function() {
  console.info('asApp.init(); Variation Code: ' + dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation);

  //oc: store the ad variation type for easy retrieval
  asApp.variation = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation;

  //oc: Step 1: map dynamic values to elements in markup
  asApp.parseDynamicContent();

  //oc: Step 2: Add Legal text behavior
  buildLegal();

  //oc: Step 3: config split text
  asApp.splitText();

  //oc: Step 4: Init TimelineLite, defaults to paused.
  tl = new TimelineLite({
    paused: 'true'
  });

  //oc: Step 5: handle variations independently.
  switch (dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation) { //oc: hardcode variation for dev line 16
    case asApp.type.AF:
      asApp.accidentForgivenessInit();
      break;
    case asApp.type.BSAH:
      asApp.bundleSaveInitAH();
      break;
    case asApp.type.BSAHP:
      asApp.bundleSaveInitAHP();
      break;
    case asApp.type.BSAHLP:
      asApp.bundleSaveInitAHLP();
      break;
    case asApp.type.BSAHL:
      asApp.bundleSaveInitAHL();
      break;
    case asApp.type.BSHLI:
      asApp.bundleSaveInitHLI();
      break;
    case asApp.type.BSALP:
      asApp.bundleSaveInitALP();
      break;
    case asApp.type.BSAL:
      asApp.bundleSaveInitAL();
      break;
    case asApp.type.BSAHMP:
      asApp.bundleSaveInitAHMP();
      break;
    case asApp.type.BSAHM:
      asApp.bundleSaveInitAHM();
      break;
    case asApp.type.BSACP:
      asApp.bundleSaveInitACP();
      break;
    case asApp.type.BSAC:
      asApp.bundleSaveInitAC();
      break;
    case asApp.type.CFD:
      asApp.claimFreeDiscountInit();
      break;
    case asApp.type.CFDM:
      asApp.claimFreeDiscountInit('mob');
      break;
    case asApp.type.CFR:
      asApp.claimFreeRewardsInit();
      break;
    case asApp.type.CRG:
      asApp.claimRateGuardInit();
      break;
    case asApp.type.CRGM:
      asApp.claimRateGuardInit('mob');
      break;
    case asApp.type.CSG:
      asApp.claimSatGuardInit();
      break;
    case asApp.type.CSGN:
      asApp.claimSatGuardInitN();
      break;
    case asApp.type.CSGM:
      asApp.claimSatGuardInitN('mob');
      break;
    case asApp.type.DW:
      asApp.driveWiseInit();
      break;
    case asApp.type.DW2P:
      asApp.driveWiseInit2P();
      break;
    case asApp.type.NR:
      asApp.newRoofInit();
      break;
    case asApp.type.TA1:
      asApp.trustedAdvisorInit('opt1');
      break;
    case asApp.type.TAM1:
      asApp.trustedAdvisorInit('mobopt1');
      break;
    case asApp.type.TAM2:
      asApp.trustedAdvisorInit('mobopt2');
      break;
    case asApp.type.WD:
      asApp.welcomeDiscountInit();
      break;
    case asApp.type.DF:
      asApp.defaultInit();
      break;
    default:
      console.log('Run default ad');
      asApp.defaultInit();
  } //end switch


  //oc: Google Fonts Fix.
  TweenLite.set("#atAd300x600", {
    visibility: "visible"
  });

  //oc: hide the loader
  $('#loader').hide();

  //oc: Step 6: kick off our timeline!
  tl.play();

}; //end asApp.init

/**a
 * This function takes the dynamic data served to the create
 * and maps it to the corresponding HTMLElement
 *
 */
asApp.parseDynamicContent = function() {
  console.info('asApp.parseDynamicContent()');

  //oc: Set bg color
  var ad300x600bg = document.getElementById('atAd300x600');
  var bg = document.getElementById('bkgColor');
  bg.style.backgroundColor = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Background_Color;
  ad300x600bg.style.backgroundColor = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Background_Color;

  //oc: Map Images
  var img1 = document.getElementById('img1');
  img1.src = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image1_300x600.Url;
  var img2 = document.getElementById('img2');
  img2.src = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image2_300x600.Url;
  var img3 = document.getElementById('img3');
  img3.src = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Image3_300x600.Url;


  //cw: Set market name.

  var marketName = document.getElementsByClassName('market-name');
  var marketNameAOrAn = document.getElementsByClassName('market-name-a-An');
  var marketNameText = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Market_Name;

  if (marketNameText = "Greater Rochester Area") {
    marketNameText = "Greater Rochester<br />Area";
  }

  var firstCharMarketName = marketNameText.charAt(0);

  if (marketNameText !== "") {
    if ((firstCharMarketName == 'A') || (firstCharMarketName == 'E') || (firstCharMarketName == 'I') || (firstCharMarketName == 'O')) {
      marketNameAOrAnText = 'An ' + marketNameText;
    } else {
      marketNameAOrAnText = 'A ' + marketNameText;
    }
    ;
  }
  ;

  for (var i = 0; i < marketName.length; i++) {
    marketName[i].innerHTML = marketNameText;
    marketNameAOrAn[i].innerHTML = marketNameAOrAnText;
  }
  ;

  //cw: set Percentages
  var percentages = document.getElementsByClassName('savings-percentage');
  var percentagesText = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Savings_Percentage;
  for (var i = 0; i < percentages.length; i++) {
    percentages[i].innerHTML = percentagesText;
  }
  ;

  //cw: from old min.js
  var n = document.getElementsByClassName("market-name"),
    o = document.getElementsByClassName("market-name-a-An"),
    d = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Market_Name,
    i = d.charAt(0);
  if (d == "Western New York") {
    document.getElementById("the").style.display = "none";
  }
  "" !== d ? "A" == i || "E" == i || "I" == i || "O" == i ? marketNameAOrAnText = "an " + d : marketNameAOrAnText = "a " + d : marketNameAOrAnText = "an ";
  for (var p = 0; p < n.length; p++) n[p].innerHTML = d; //oc: use html text from feed...n[p].innerText ? n[p].innerText = d : n[p].textContent && (n[p].textContent = d);
  for (var p = 0; p < o.length; p++) o[p].innerHTML = marketNameAOrAnText; //oc: use html text from feed... o[p].innerText ? o[p].innerText = marketNameAOrAnText : o[p].textContent && (o[p].textContent = marketNameAOrAnText);
  for (var r = document.getElementsByClassName("savings-percentage"),
      m = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Savings_Percentage, p = 0; p < r.length; p++) r[p].innerText ? r[p].innerText = m : r[p].textContent && (r[p].textContent = m);
  var c = document.getElementById("aAd_legalTxt"),
    A = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Legal_Copy;
  c.innerText ? c.innerText = A : c.textContent && (c.textContent = A);


  //cw: Set legal copy
  var legalCopy = document.getElementById('aAd_legalTxt');
  var legalCopyText = dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Legal_Copy;
  legalCopy.innerHTML = legalCopyText;
}; //end asApp.parseDynamicContent() function

/**
 * This function splits the text so each word can by styled/animated
 */
asApp.splitText = function() {

  //oc: only include current variation's divs in the Split Text call.
  var frame3Selector = '#' + dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation + ' .frame3';
  var frame3aSelector = '#' + dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation + ' .frame3a';
  var frame4Selector = '#' + dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation + ' .frame4';
  var frame5Selector = '#' + dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation + ' .frame5';
  console.log('frame3Selector:' + frame3Selector);

  //oc: only split what we have to and in the right way.
  switch (dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation) {
    case asApp.type.DW2P:
      var frame6Selector = '#' + dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation + ' .frame6';
      frame6 = new SplitText(frame6Selector, {
        type: "lines,words,chars",
        wordsClass: "word++",
        charsClass: "chars++"
      });

    case asApp.type.DW:
      frame3 = new SplitText(frame3Selector, {
        type: "lines,words,chars",
        wordsClass: "word++",
        charsClass: "chars++"
      });
      frame4 = new SplitText(frame4Selector, {
        type: "lines,words,chars",
        wordsClass: "word++",
        charsClass: "chars++"
      });
      frame5 = new SplitText(frame5Selector, {
        type: "lines,words,chars",
        wordsClass: "word++",
        charsClass: "chars++"
      });
      break;
    case asApp.type.WD:
      frame3 = new SplitText(frame3Selector, {
        type: "words",
        wordsClass: "word++"
      });
      break;

    case asApp.type.CRG:
      frame3 = new SplitText(frame3Selector, {
        type: "lines,words,chars",
        wordsClass: "word++",
        charsClass: "chars++"
      });
      frame4 = new SplitText(frame4Selector, {
        type: "lines,words,chars",
        wordsClass: "word++",
        charsClass: "chars++"
      });
      break;

    case asApp.type.CFD:
      frame3 = new SplitText(frame3Selector, {
        type: "lines,words,chars",
        wordsClass: "word++",
        charsClass: "chars++"
      });
      frame4 = new SplitText(frame4Selector, {
        type: "lines,words,chars",
        wordsClass: "word++",
        charsClass: "chars++"
      });
      break;

    case asApp.type.BSAHL:
    case asApp.type.BSAHLP:
    case asApp.type.BSAHMP:
      frame3 = new SplitText(frame3Selector, {
        type: "words",
        wordsClass: "word++"
      });
      frame3a = new SplitText(frame3aSelector, {
        type: "words",
        wordsClass: "word++"
      });
      frame4 = new SplitText(frame4Selector, {
        type: "words",
        wordsClass: "word++"
      });
      frame5 = new SplitText(frame5Selector, {
        type: "words",
        wordsClass: "word++"
      });

      break;


    case asApp.type.TA1:
      frame3 = new SplitText(frame3Selector, {
        type: "words",
        wordsClass: "word++"
      });
      frame4 = new SplitText(frame4Selector, {
        type: "words",
        wordsClass: "word++"
      });
      frame5 = new SplitText(frame5Selector, {
        type: "words",
        wordsClass: "word++"
      });
      //cw: For only Greater Rochester Area do this on frame5
      if ((dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation == "TA1") && (dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Market_Name == "Greater Rochester Area")) {
        $('.frame5').html('in<br>the <span class="market-name">Greater Rochester Area</span>');
        frame5 = new SplitText(frame5Selector, {
          type: "words",
          wordsClass: "word++"
        });
      }
      ;

      break;


    case asApp.type.BSAH:
    case asApp.type.BSAHP:
    case asApp.type.BSAL:
    case asApp.type.BSALP:
    case asApp.type.BSACP:
      frame3 = new SplitText(frame3Selector, {
        type: "words",
        wordsClass: "word++"
      });
      frame3a = new SplitText(frame3aSelector, {
        type: "words",
        wordsClass: "word++"
      });
      frame4 = new SplitText(frame4Selector, {
        type: "words",
        wordsClass: "word++"
      });

      break;

    default: //oc: most of the time, there are only 4 frames
      frame3 = new SplitText(frame3Selector, {
        type: "words",
        wordsClass: "word++"
      });
      frame4 = new SplitText(frame4Selector, {
        type: "words",
        wordsClass: "word++"
      });
  } //end switch


};

/**
 * This function takes the timeline as a parameter and
 * puts the Hands animation on it.
 */
asApp.addHandsFrameToTimeline = function() {

  tl.to(".in1", 0.2, {
    autoAlpha: 1
  });
  tl.to(".in2", 0.2, {
    autoAlpha: 1
  });
  tl.to(".in3", 0.2, {
    autoAlpha: 1
  });
  tl.to(".in4", 0.2, {
    autoAlpha: 1
  });
  tl.to(".in5", 0.2, {
    autoAlpha: 1
  });

  tl.from("#hands", .6, {
    scaleX: 0,
    scaleY: 0,
    ease: Back.easeInOut,
    easeParams: [2],
    transformOrigin: "40% 40%",
    opacity: 0
  });

  tl.to(".message", .5, {
    autoAlpha: 0,
    delay: 1
  });
}; //end function

asApp.addGetINFrameToTimeline = function() {

  //oc: add SplitText
  getIN = new SplitText('#getIN', {
    type: "words",
    wordsClass: "word++"
  });

  //oc: set style
  $("#getIN .word2").attr('class', 'whiteIN');

  //oc: GetIn Frame BEGIN
  tl.staggerFrom(getIN.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to("#getIN", 0.3, {
    autoAlpha: 0,
    delay: 2
  });
//oc: GetIn Frame 2 END
};

asApp.addHereINFrameToTimeline = function() {

  //oc: Split text
  hereIN = new SplitText('#hereIN', {
    type: "words",
    wordsClass: "word++"
  });

  //oc: set style
  $("#hereIN .word2").attr('class', 'whiteIN');

  //cw: For only BSHLI and Massachusetts
  //sb: set style
  $("#hereIN .word3").attr('class', 'the');
  $("#hereIN").addClass(dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation);
  //cw:
  if ((dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Market_Name == "Massachusetts") && (dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Variation == "BSHLI")) {
    $('#hereIN.BSHLI .the').css("display", "none");
  }
  ;

  //oc: HereIn Frame BEGIN
  tl.staggerFrom(hereIN.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to("#hereIN", 0.3, {
    autoAlpha: 0,
    delay: 2
  });
//oc: HereIn Frame 2 END
};

/**
 * This function scripts the Image wipe/reveal transitions
 * @param {int} $numImages - number of images in the creative
 */
asApp.addImageFramesToTimeline = function($variation) {

  //oc: background reveal
  tl.to("#bkgColor", 0.7, {
    top: -600,
    ease: Sine.easeOut
  });

  //oc: show first line of text

  tl.staggerFrom(frame3.words, 0.2, {
    left: -300
  }, 0.07)

  //oc: fade
  tl.to(".frame3", 0.3, {
    autoAlpha: 0,
    delay: 2
  });

  tl.to("#bgImg2", 0.5, {
    bottom: -2,
    ease: Sine.easeOut
  });

  tl.staggerFrom(frame4.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to(".frame4", 0.3, {
    autoAlpha: 0,
    delay: 2
  });

  if ((asApp.variation == 'DW1') || (asApp.variation == 'DW2P')) {
    console.log('only DW')
    $(".frame3 .word2").attr('class', 'txtWhite');

    tl.staggerFrom(frame5.words, 0.2, {
      left: -300
    }, 0.07)

    tl.to(".frame5", 0.3, {
      autoAlpha: 0,
      delay: 2
    });

  }
  if (asApp.variation == 'DW2P') {
    console.log('only DW')
    $(".frame3 .word2").attr('class', 'txtLtBlue');

    //oc:


    tl.staggerFrom(frame6.words, 0.2, {
      left: -300
    }, 0.07)

    tl.to(".frame6", 0.3, {
      autoAlpha: 0,
      delay: 2
    });

  }

  tl.to("#bkgColor", 0.7, {
    top: 0,
    ease: Sine.easeOut
  });
}; //end asApp.addImageFramesToTimeline function

asApp.addNRImageFramesToTimeline = function($variation) {

  tl.to("#bkgColor", 0.7, {
    top: -600,
    ease: Sine.easeOut
  });

  tl.staggerFrom(frame3.words, 0.2, {
    left: -300
  }, 0.07)

  //oc: fade
  tl.to("#NR .frame3", 0.3, {
    autoAlpha: 0,
    delay: 2
  });

  tl.to("#bgImg1", 0.5, {
    left: -300,
    ease: Sine.easeOut
  });

  tl.to("#bgImg2", 0, {
    bottom: -5,
    left: 300,
    ease: Sine.easeOut,
    delay: -0.5
  });

  tl.to("#bgImg2", 0.5, {
    left: 0,
    ease: Sine.easeOut,
    delay: -0.5
  });

  tl.staggerFrom(frame4.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to(".frame4", 0.3, {
    autoAlpha: 0,
    delay: 2
  });

  tl.to("#bgImg2", 0.5, {
    autoAlpha: 0,
    delay: -0.5
  });


}; //end

asApp.addTAImageFramesToTimeline = function($variation) {

  //oc: background reveal
  tl.to("#bkgColor", 0.7, {
    top: -600,
    ease: Sine.easeOut
  });

  tl.staggerFrom(frame3.words, 0.2, {
    left: -300
  }, 0.07)

  //oc: fade
  tl.to(".frame3", 0.3, {
    autoAlpha: 0,
    delay: 1.5
  });

  tl.staggerFrom(frame4.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to(".frame4", 0.3, {
    autoAlpha: 0,
    delay: 1.5
  });

  tl.staggerFrom(frame5.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to(".frame5", 0.3, {
    autoAlpha: 0,
    delay: 1.5
  });
  tl.to("#bkgColor", 0.7, {
    top: 0,
    ease: Sine.easeOut
  });


}; //end asApp.addImageFramesToTimeline function


asApp.addBS3FramesToTimeline = function($variation) {

  tl.to("#bkgColor", 0.7, {
    top: -600,
    ease: Sine.easeOut
  });

  tl.staggerFrom([frame3.lines, frame3a.lines], 0.2, {
    left: -728,
  }, 0.07)

  tl.to("#bgImg2", 0.5, {
    bottom: -2,
    ease: Sine.easeOut,
    delay: 1
  });

  tl.staggerFrom(frame4.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to("#bgImg3", 0.5, {
    bottom: -2,
    ease: Sine.easeOut,
    delay: 1
  });

  tl.staggerFrom(frame5.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to(".BShide", 0.3, {
    autoAlpha: 0,
    delay: 1
  });

  tl.to("#bkgColor", 0.7, {
    top: 0,
    ease: Sine.easeOut
  });
}; //end asApp.add3ImageFramesToTimeline function

//oc: add variation
asApp.addBS2FramesToTimeline = function($variation) {

  tl.to("#bkgColor", 0.7, {
    top: -600,
    ease: Sine.easeOut
  });

  tl.staggerFrom([frame3.lines, frame3a.lines], 0.2, {
    left: -728,
  }, 0.07)

  tl.staggerFrom(frame4.words, 0.2, {
    left: -300,
    delay: 2,
  }, 0.07)

  tl.to("#bgImg2", 0.5, {
    bottom: -2,
    ease: Sine.easeOut,
    delay: -1
  });

  tl.to(".BShide", 0.3, {
    autoAlpha: 0,
    delay: 1
  });

  tl.to("#bkgColor", 0.7, {
    top: 0,
    ease: Sine.easeOut
  });
}; //end asApp.add2ImageFramesToTimeline function

asApp.addWDTimeline = function($variation) {
  tl.to("#bkgColor", 0.7, {
    top: -600,
    ease: Sine.easeOut
  });

  tl.staggerFrom(frame3.words, 0.2, {
    left: -300
  }, 0.07)

  tl.to("#bkgColor", 0.7, {
    top: 0,
    delay: 2.5,
    ease: Sine.easeOut
  });

};

/**
 * This function adds the landing frame's animation sequence to the timeline.
 * @param {string} $variation - abbreviation code for which creative is shown
 */
asApp.addLandingToTimeline = function($variation) {
  tl.to(".fade", 0.3, {
    autoAlpha: 1
  });

  tl.to(".fade1", 0.3, {
    autoAlpha: 1
  });

  tl.to("#landing", 1, {
    autoAlpha: 1
  });

  if (asApp.variation == 'DW1') {
    tl.to("#onlyAllstate", 0.5, {
      left: 0
    });

    console.log("version1")
  }
  if (asApp.variation == 'DW2P') {
    tl.to("#onlyAllstate2", 0.5, {
      left: 0
    });
    tl.to("#phone", 0.3, {
      left: 0
    });
    console.log("version2")
  }

  tl.to("#btn_cta", 0.3, {
    right: -9,
    autoAlpha: 1,
    delay: -0.5
  });

  tl.to("#btn_cta", 0.3, {
    right: -20,
    repeat: 2,
    yoyo: true,
    ease: Linear.easeNone
  });

};

/**
  * This function handles the Accident Forgiveness variations
  * @param - ad variation option
  * Global syles:
      - Background: #8b86ca
      - CTA:    “GET IN”
  * Keyframes :
      1 : Logo Lockup
      2 :
        Top-aligned paragraph -
        Font size: 36 px
        Copy: “GET IN ON THIS, [MARKET NAME]”
      3 : Photo w/ ⅓ - top White Copy
        Copy : “FORGIVENESS”
      4 : Photo w/ ⅓ - bottom white copy
        Copy : “EVEN IF IT’S YOUR FAULT”
      5 : End Frame
        OPTION ONE:
          Top-aligned large copy - 36 px
          Larger copy: “ACCIDENT FORGIVENESS”
          Smaller copy - 18px
            “Connect with a [Market Name] Allstate Agent”
        OPTION TWO:
          Top-aligned large copy - 36 px
          Larger opy: “ACCIDENT FORGIVENESS”
          Smaller copy - 18px
*/

//show CFR
asApp.defaultInit = function() {
  console.info('defaultInit');
  $(".frame4 .word8").attr('class', 'reg2');
  $('#DF, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

} //end CFR


asApp.accidentForgivenessInit = function() {
  console.info('accidentForgivenessInit');

  $('#AF, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();


} //end accidentForgivenessInit() function

//oc: show Auto Home
asApp.bundleSaveInitAH = function() {
  console.info('oc: asApp.bundleSaveInitAH():');

  //show bundleSave elements
  $('#BSAH, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addBS2FramesToTimeline();
  asApp.addLandingToTimeline();


  console.debug('oc: Auto Home');
}; //end function bundleSaveInit

//oc: show Auto Home WITH Percentage
asApp.bundleSaveInitAHP = function() {
  console.info('oc: asApp.bundleSaveInitAHP():');

  //show bundleSave elements
  $('#BSAHP, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addBS2FramesToTimeline();
  asApp.addLandingToTimeline();


  console.debug('oc: Auto Home with percent');
}; //end function bundleSaveInit

//show Auto Home Life
asApp.bundleSaveInitAHL = function() {
  console.info('asApp.bundleSaveInitAHL()');

  //show bundleSave elements
  $('#BSAHL, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addBS3FramesToTimeline();
  asApp.addLandingToTimeline();


  console.debug('Auto Home Life');
}; //end function bundleSaveInit

//show Auto Home Life %
asApp.bundleSaveInitAHLP = function() {
  console.info('asApp.bundleSaveInitAHLP()');

  //show bundleSave elements
  $('#BSAHLP, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();

  asApp.addBS3FramesToTimeline();
  asApp.addLandingToTimeline();


  console.debug('Auto Home Life %');
}; //end function bundleSaveInit


//show Auto Life
asApp.bundleSaveInitAL = function() {

  console.info('asApp.bundleSaveInitAL()');

  //show bundleSave elements
  $('#BSAL, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addBS2FramesToTimeline();
  asApp.addLandingToTimeline();

  console.debug('Auto Life');
}; //end function bundleSaveInit


//cw: show Auto Life %
asApp.bundleSaveInitALP = function() {
  console.info('asApp.bundleSaveInitALP()');

  //show bundleSave elements
  $('#BSALP, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();

  asApp.addBS3FramesToTimeline();
  asApp.addLandingToTimeline();


  console.debug('Auto Life %');
}; //end function bundleSaveInit


asApp.bundleSaveInitAHMP = function() {
  //show Auto Home Moto $option) {
  console.info('asApp.bundleSaveInitAHMP()');

  //show bundleSave elements
  $('#BSAHMP, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addBS3FramesToTimeline();
  asApp.addLandingToTimeline();

  console.debug('Auto home moto %');

};


//show Auto Home Life
asApp.bundleSaveInitAHL = function() {
  //show Auto Home Moto $option) {

  $('#BSAHL, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addBS3FramesToTimeline();
  asApp.addLandingToTimeline();

  console.debug('Auto Home Life ');

}; //end function bundleSaveInit

//show Auto Condo percent
asApp.bundleSaveInitACP = function(pp) {

  console.info('asApp.bundleSaveInitACP()');

  //show bundleSave elements
  $('#BSACP, #getIN, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addBS2FramesToTimeline();
  asApp.addLandingToTimeline();

  console.debug('Auto Condo percent');
}; //end function bundleSaveInit

//show Home + Life
asApp.bundleSaveInitHLI = function(pp) {

  console.info('asApp.bundleSaveInitHLI()');
  $(".frame4 .word5").attr('class', 'txtWhite');

  //show bundleSave elements
  $('#BSHLI, #hereIN, #Allstate').css('display', 'block');
  asApp.addHereINFrameToTimeline();
  asApp.addHandsFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

  console.debug('home+life');
}; //end function Home + Life

//show CFD
asApp.claimFreeDiscountInit = function() {
  console.info('claimFreeDiscountInit');
  $(".frame3 .word6 .chars25, .frame3 .word6 .chars26").attr('class', 'txtWhite');
  $(".frame4 .word6 .chars20, .frame4 .word6 .chars21").attr('class', 'txtWhite');

  $('#CFD, #hereIN, #Allstate_Home').css('display', 'block');
  asApp.addHereINFrameToTimeline();
  asApp.addHandsFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

} //end CFD

//show CFR
asApp.claimFreeRewardsInit = function() {
  console.info('claimFreeRewardsInit');

  $('#CFR, #hereIN, #Allstate_Home').css('display', 'block');
  asApp.addHereINFrameToTimeline();
  asApp.addHandsFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

} //end CFR

//cw: show CRG
asApp.claimRateGuardInit = function() {
  console.info('claimRateGuardInit');
  $(".frame3 .word5 .chars28, .frame3 .word5 .chars29").attr('class', 'txtWhite');
  $(".frame4 .word6 .chars25, .frame4 .word6 .chars26").attr('class', 'txtWhite');

  $('#CRG, #hereIN, #Allstate_Home').css('display', 'block');
  asApp.addHereINFrameToTimeline();
  asApp.addHandsFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

} //end CRG

//cw: show CSG
asApp.claimSatGuardInit = function() {
  console.info('claimSatGuardInit');

  $('#CSG, #hereIN, #Allstate').css('display', 'block');
  asApp.addHereINFrameToTimeline();
  asApp.addHandsFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

} //end CSG

//cw: show CSGN
asApp.claimSatGuardInitN = function() {
  console.info('claimSatGuardInitN');

  $('#CSGN, #hereIN, #Allstate').css('display', 'block');
  asApp.addHereINFrameToTimeline();
  asApp.addHandsFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

} //end CSG

//show DW
asApp.driveWiseInit = function() {
  console.info('driveWiseInit');
  $(".frame4 .word5 .chars27,.frame4 .word5 .chars28").attr('class', 'txtWhite');
  $(".frame5 .word4 .chars20, .frame5 .word4 .chars21").attr('class', 'txtWhite');

  $('#DW1, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

  console.log('DW1');

} //end DW

//show DW
asApp.driveWiseInit2P = function() {
  console.info('driveWiseInit2P');
  $(".frame4 .word3 .chars13,.frame4 .word3 .chars14").attr('class', 'txtWhite');
  $(".frame5 .word4 .chars20, .frame5 .word4 .chars21").attr('class', 'txtWhite');
  $(".frame6 .word2 .chars9, .frame6 .word2 .chars10").attr('class', 'txtWhite');

  $('#DW2P, #Allstate').css('display', 'block');

  asApp.addHandsFrameToTimeline();
  asApp.addImageFramesToTimeline();
  asApp.addLandingToTimeline();

  console.log('DW');

} //end DW

//show Auto Condo percent
asApp.welcomeDiscountInit = function(pp) {

  console.info('asApp.welcomeDiscountInit()');

  //show bundleSave elements
  $('#WD, #getIN, #Allstate_Home').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addGetINFrameToTimeline();
  asApp.addWDTimeline();
  asApp.addLandingToTimeline();

  console.debug('welcome Discount');
}; //end function bundleSaveInit


/**
 * This function scripts the New Roof variation
 */

asApp.newRoofInit = function() {
  console.info('asApp.newRoofInit()');

  //show bundleSave elements
  $('#NR, #hereIN, #Allstate_Home').css('display', 'block');
  asApp.addHereINFrameToTimeline();
  asApp.addHandsFrameToTimeline();
  asApp.addNRImageFramesToTimeline();
  asApp.addLandingToTimeline();

  console.debug('new roof');
}; //end function bundleSaveInit

asApp.trustedAdvisorInit = function() {
  console.info('asApp.trustedAdvisorInit()');
  $(".frame3 .word1").attr('class', 'txtWhite');
  $(".frame4 .word1").attr('class', 'txtWhite');
  $(".frame5 .word1").attr('class', 'txtWhite');

  //show bundleSave elements
  $('#TA1, #Allstate').css('display', 'block');
  asApp.addHandsFrameToTimeline();
  asApp.addTAImageFramesToTimeline();
  asApp.addLandingToTimeline();

  console.debug('new roof');
}; //end function bundleSaveInit


/**
 * This function scripts the Drivewise variations
 */


// oc: CTA Mouseover handlers
var div1 = $("div#btn_cta"),
  tn1 = TweenMax.to(div1, .3, {
    right: 0,
    repeat: 10,
    yoyo: true,
    ease: Linear.easeNone,
    paused: true
  });

div1.mouseenter(function() {
  tn1.play();
});

div1.mouseleave(function() {
  var currentTime = tn1.time();
  tn1.reverse(currentTime);
});

/**
 * This function handles the Background and CTA clicks
 * And overrides the system's exit to navigate to a dynamic exit url
 */
function onExitClick(event) {
  console.info('onExitClick()');
  Enabler.exitOverride('CTA Exit', dynamicContent.aslocalfeed_Allstate_Local_Feed[0].Exit_URL.Url)
// Enabler.exit();
}
;
